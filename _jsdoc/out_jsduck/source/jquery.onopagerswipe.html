<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @fileOverview Swiping code for mobile browsers. Lots of code comes from the
 *               QuickGestures jQuery plugin of Anders Zakrisson.
 */

(function($) {
<span id='global-method-onoPagerSwipe'>  /**
</span>   * Handles swipe events on mobile phones and desktops. The code is based on
   * the QuickGestures jQuery plugin of Anders Zakrisson.
   *
   * @return {Object} chainable jQuery class.
   * @memberOf jQuery.fn
   * @param {Object|Null} arg_config Swipe config.
   * @param {Function} arg_config.dragLeft Handles drag left event.
   * @param {Function} arg_config.dragRight Handles drag right event.
   * @param {Function} arg_config.dragUp Handles drag up event.
   * @param {Function} arg_config.dragDown Handles drag down event.
   * @param {Number} arg_config.threshold Number of pixels that have to be
   *    dragged before something is considered a swipe.
   * @param {String} arg_config.platform Determines on what platforms
   *    the user is able to page by swiping. 'touch' activates swiping only on
   *    touch devices. 'all' will activates swiping on touch devices and
   *    desktop. Swiping on the desktop is done with mouse gestures. Default
   *    value is 'touch'.
   */
  jQuery.fn.onoPagerSwipe = function(arg_config) {
    var config = {
      dragLeft: null,
      dragRight: null,
      dragUp: null,
      dragDown: null,
      threshold: 75,
      platform: 'touch',
      pageDirection: ''
    };
    config = $.extend(true, config, arg_config);

    return this.each(function() {
      var data = {
        x: 0,
        y: 0,
        t: null
      };

      if (config.platform == 'touch') {
        // Check if browser supports touch events
        var el = document.createElement('div');
        el.setAttribute('ontouchstart', '');
        el.setAttribute('ontouchmove', '');
        el.setAttribute('ontouchend', '');
        if (typeof (el.ontouchstart) != 'function' ||
            typeof (el.ontouchmove) != 'function' ||
            typeof (el.ontouchend) != 'function') {
          config.platform = '';
        }
      }

      if (config.platform == 'touch' || config.platform == 'all') {
        // Handle swipes on mobile browsers
        var lastPageX, lastPageY, offsetLeft, offsetTop;

        this.addEventListener('touchstart', function(e) {
          offsetLeft = ($(window).width() - $(this).outerWidth(true)) / 2;
          offsetTop = ($(window).height() - $(this).outerHeight(true)) / 2;
          data.x = e.targetTouches[0].pageX - offsetLeft;
          data.y = e.targetTouches[0].pageY - offsetTop;
        }, false);

        this.addEventListener('touchmove', function(e) {
          lastPageX = e.targetTouches[0].pageX - offsetLeft;
          lastPageY = e.targetTouches[0].pageY - offsetTop;

          var diffX = lastPageX - data.x;
          var diffY = lastPageY - data.y;
          if (diffX &lt; 0) {
            diffX = -diffX;
          }
          if (diffY &lt; 0) {
            diffY = -diffY;
          }
          if (config.pageDirection == 'horizontal' &amp;&amp; diffX &gt; diffY ||
              config.pageDirection == 'vertical' &amp;&amp; diffY &gt; diffX) {
            // prevents either horizontal or vertical scrolling through swiping
            // The orientation it cancels depends on the orientation in
            // the config.
            e.preventDefault();
            jQuery('preventDefault');
          } else {
            jQuery('default');
          }
        }, false);

        this.addEventListener('touchend', function(e) {
          e.preventDefault();
          var diffX = lastPageX - data.x;
          var diffY = lastPageY - data.y;

          if (diffX &lt;= -config.threshold) {
            if ($.isFunction(config.dragLeft)) {
              config.dragLeft();
            }
          } else if (diffX &gt;= config.threshold) {
            if ($.isFunction(config.dragRight)) {
              config.dragRight();
            }
          }

          if (diffY &lt;= -config.threshold) {
            if ($.isFunction(config.dragUp)) {
              config.dragUp();
            }
          } else if (diffY &gt;= config.threshold) {
            if ($.isFunction(config.dragDown)) {
              config.dragDown();
            }
          }
        }, false);
      }
      if (config.platform == 'all') {
        // Handles swipes on desktop
        $(this).mousedown(function(e) {
          var offsetLeft = ($(window).width() - $(this).outerWidth(true)) / 2;
          var offsetTop = ($(window).height() - $(this).outerHeight(true)) / 2;
          data.x = e.pageX - offsetLeft;
          data.y = e.pageY - offsetTop;

          $(this).bind('mousemove', function(e) {
            $(this).bind('mouseup', function() {
              $(this).unbind('mousemove');
            });
            // Handles horizontal swipes
            var diffX = (e.pageX - offsetLeft) - data.x;
            var diffY = (e.pageY - offsetTop) - data.y;

            if (diffX &lt;= -config.threshold) {
              $(this).unbind('mousemove');
              if ($.isFunction(config.dragLeft)) {
                config.dragLeft();
              }
            } else if (diffX &gt;= config.threshold) {
              $(this).unbind('mousemove');
              if ($.isFunction(config.dragRight)) {
                config.dragRight();
              }
            }

            // Handle vertical swipes
            if (diffY &lt;= -config.threshold) {
              $(this).unbind('mousemove');
              if ($.isFunction(config.dragUp)) {
                config.dragUp();
              }
            } else if (diffY &gt;= config.threshold) {
              $(this).unbind('mousemove');
              if ($.isFunction(config.dragDown)) {
                config.dragDown();
              }
            }
          });
        });
      }
    });
  };
})(jQuery);
</pre>
</body>
</html>
